{% load static %}
{% load previous_donation %}
{% load linebreak %}
<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="UTF-8">
		<meta name="viewport" content="width=device-width, initial-scale=1.0">
		<meta name="apple-mobile-web-app-capable" content="yes">
		<meta name="apple-mobile-web-app-status-bar-style" content="default">
		<meta http-equiv="Content-Security-Policy" content="default-src * 'self' 'unsafe-inline' 'unsafe-eval' data: gap:">
		<link rel="icon" href="images/favicon.png">
		<title>Osvaro - Neomorphism Design Mobile Template UI Kit</title>
		<link href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,500,500i,700,900&display=swap" rel="stylesheet">
		<link rel="stylesheet" href="{% static 'css/framework7.bundle.min.css' %}">
		<link rel="stylesheet" href="{% static 'css/font-awesome.min.css' %}">
		<link rel="stylesheet" href="{% static 'css/style.css' %}">
	</head>
	<body>
		
		<div id="app">
			<div class="view view-main view-init" data-url="/">
				<div class="page page-home page-with-subnavbar">
					<div class="toolbar tabbar tabbar-labels toolbar-bottom">
						<div class="toolbar-inner">
							<a data-page="home-page" class="tab-link tab-link-active">
								<i class="fa fa-home"></i>
								<p>Home</p>
							</a>
							<a data-page="donate-page" class="tab-link">
								<i class="fas fa-star"></i>
								<p>Donate</p>
							</a>
							<a data-page="phone-book-page" class="tab-link">
								<i class="fas fa-clone"></i>
								<p>PhoneBook</p>
							</a>
							<a data-page="profile-page" class="tab-link">
								<i class="fas fa-cog"></i>
								<p>Account</p>
							</a>
						</div>
					</div>
					
					<!-- tabs -->
					<div class="tabs-animated-wrap">
						<div class="tabs">
							<!-- tabs 1 -->
							<div id="home-page" class="tab page-content page-active">
								<!-- home -->
								<div class="container">
									<div class="separator"></div>
									<!-- title home -->
									<div class="title-home">
										<div class="content">
											<span>Welcome to </span>
											<h1>Gazipur Blood Donners</h1>
											<p>Is a Neomorphism Design Mobile Template UI Kit with easy to customize</p>
										</div>
									</div>
									<!-- end title home -->
									<div class="separator"></div>
									<!-- features -->
									<div class="features-home">
										<h3>Blood Groups</h3>
										<div class="row icon-color">
											<div class="col blood-grp" data-blood="ap">
												<div class="content">
													<img src="images/ap.webp" alt="A positive" style="height: 70px; width:70px;">
													<h6>A Positive</h6>
												</div>
											</div>
											<div class="col blood-grp" data-blood="ap">
												<div class="content">
													<img src="images/an.png" alt="A negetive" style="height: 70px; width:70px;">
													<h6>A Negetive</h6>
												</div>
											</div>
											
											<div class="col blood-grp" data-blood="ap">
												<div class="content">
													<img src="images/bp.webp" alt="B positive" style="height: 70px; width:70px;">
													<h6>B Positive</h6>
												</div>
											</div>
										</div>
										<div class="row icon-color2">
											<div class="col blood-grp" data-blood="ap">
												<div class="content">
													<img src="images/bn.png" alt="B Negetive" style="height: 70px; width:70px;">
													<h6>B Negetive</h6>
												</div>
											</div>
											<div class="col blood-grp" data-blood="ap">
												<div class="content">
													<img src="images/abp.png" alt="AB positive" style="height: 70px; width:70px;">
													<h6>AB Positive</h6>
												</div>
											</div>
											<div class="col blood-grp" data-blood="ap">
												<div class="content">
													<img src="images/abn.png" alt="AB Negetive" style="height: 70px; width:70px;">
													<h6>AB Negetive</h6>
												</div>
											</div>
										</div>
										<div class="row icon-color">
											<div class="col blood-grp" data-blood="ap">
												<div class="content">
													<img src="images/op.png" alt="O positive" style="height: 70px; width:70px;">
													<h6>O Positive</h6>
												</div>
											</div>
											<div class="col blood-grp" data-blood="ap">
												<div class="content">
													<img src="images/on.png" alt="O Negetive" style="height: 70px; width:70px;">
													<h6>O Negetive</h6>
												</div>
											</div>
										</div>
									</div>
									<!-- end features -->
									<div class="separator"></div>
									<!-- follow us -->
									<div class="follow-us">
										<h3>Follow us on :</h3>
										<ul>
											<li>
												<a href="{% url "home" %}"><span class="socmed-bg-facebook">
													<i class="fab fa-facebook-f"></i>
												</span></a>
											</li>
											<li>
												<a href="{% url "home" %}"><span class="socmed-bg-twitter">
													<i class="fab fa-twitter"></i>
												</span></a>
											</li>
											<li>
												<a href="{% url "home" %}"><span class="socmed-bg-whatsapp">
													<i class="fab fa-whatsapp"></i>
												</span></a>
											</li>
											<li>
												<a href="{% url "home" %}"><span class="socmed-bg-google">
													<i class="fab fa-google"></i>
												</span></a>
											</li>
										</ul>
									</div>
									<!-- end follow us -->
									<!-- end features -->
									<div class="separator-big"></div>
								</div>
								<!-- end home -->
							</div>
							<!-- end tabs 1 -->
							<!-- tabs 2 -->
							<div id="donate-page" class="tab page-content">
								<!-- elements -->
								<div class="container">
									<div class="separator"></div>
									<div class="page page-current">
										<!-- navbar -->
									   <div class="navbar">
										   <div class="navbar-inner sliding navbar-pages">
											<a data-page="home-page" class="tab-link link back">
												<i class="fa fa-home"></i>
											</a>
											   <h4>Donate Us</h4>
											  <div class="item-right"></div>
										   </div>
									   </div>
									   <!-- end navbar -->
									   <div class="page-content">
										   <!-- accordion -->
										   <div class="segments-page">
											<!-- why we need donates  -->
											<div class="container tooltip-pages">
												<div class="content-box"> 
													<p class="">Lorem ipsum dolor sit amet, consectetur adipisicing elit. Rem quasi eos ipsam repudiandae illo nulla ducimus inventore saepe ut natus. <i class="fas fa-info-circle tooltip-init" data-tooltip="Tooltip text"></i></p>
												</div>
												<div class="separator"></div>
											</div>
											<!-- end  -->
											   <div class="container">
												   
												   <div class="accordion accordion-icon content-entry">
													   <div class="list accordion-list">
														   <ul>
															   <li class="accordion-item">
																   <a href="" class="item-link item-content">
																	   <div class="item-inner">
																		   <div class="item-title"><i class="fa fa-dollar-sign"></i>BKash Account</div>
																	   </div>
																   </a>
																   <div class="accordion-item-content">
																	   <p>Lorem ipsum dolor sit amet, consectetur adipisicing elit. Inventore dolores sed perspiciatis quia nihil beatae quis atque labore quaerat nemo.</p>
																   </div>
															   </li>
															   <li class="accordion-item">
																   <a href="" class="item-link item-content">
																	   <div class="item-inner">
																		   <div class="item-title"><i class="fa fa-dollar-sign"></i>Nagad Accoutnt</div>
																	   </div>
																   </a>
																   <div class="accordion-item-content">
																	   <p>Lorem ipsum dolor sit amet, consectetur adipisicing elit. Inventore dolores sed perspiciatis quia nihil beatae quis atque labore quaerat nemo.</p>
																   </div>
															   </li>
															   <li class="accordion-item">
																   <a href="" class="item-link item-content">
																	   <div class="item-inner">
																		   <div class="item-title"><i class="fa fa-dollar-sign"></i>Rocket Accout</div>
																	   </div>
																   </a>
																   <div class="accordion-item-content">
																	   <p>Lorem ipsum dolor sit amet, consectetur adipisicing elit. Inventore dolores sed perspiciatis quia nihil beatae quis atque labore quaerat nemo.</p>
																   </div>
															   </li>
															   <li class="accordion-item">
																   <a href="" class="item-link item-content">
																	   <div class="item-inner">
																		   <div class="item-title"><i class="fa fa-credit-card"></i>Bank Transfer</div>
																	   </div>
																   </a>
																   <div class="accordion-item-content">
																	   <p>Lorem ipsum dolor sit amet, consectetur adipisicing elit. Inventore dolores sed perspiciatis quia nihil beatae quis atque labore quaerat nemo.</p>
																   </div>
															   </li>
														   </ul>
													   </div>
												   </div>
												   <!-- end accordion icon -->
												   
												   
											   </div>
										   </div>
										   <!-- end accordion -->
									   </div>
									   
								   </div>
								</div>
								<!-- end elements -->
								<div class="separator-big"></div>
							</div>
							<!-- end tabs 2 -->
							<!-- tabs 3 -->
							<div id="phone-book-page" class="tab page-content">
								<!-- pages -->
								<div class="container">
									<div class="separator"></div>
									<div class="list-li">
										<ul>
											<li>
												<a href="https://astylers.com/about-us/">
													<i class="fa fa-user"></i> About us <span><i class="fa fa-chevron-right"></i></span>
												</a>
											</li>
											<li>
												<a href="https://astylers.com/blog/">
													<i class="fa fa-rss"></i> Blog <span><i class="fa fa-chevron-right"></i></span>
												</a>
											</li>
											<li>
												<a href="https://astylers.com/blog-single/">
													<i class="fa fa-th-list"></i> Blog Single <span><i class="fa fa-chevron-right"></i></span>
												</a>
											</li>
											<li>
												<a href="https://astylers.com/career/">
													<i class="fa fa-tags"></i> Career <span><i class="fa fa-chevron-right"></i></span>
												</a>
											</li>
											<li>
												<a href="https://astylers.com/client/">
													<i class="fa fa-th-large"></i> Clients <span><i class="fa fa-chevron-right"></i></span>
												</a>
											</li>
											<li>
												<a href="https://astylers.com/features/">
													<i class="fa fa-star"></i> Features <span><i class="fa fa-chevron-right"></i></span>
												</a>
											</li>
											<li>
												<a href="https://astylers.com/gallery/">
													<i class="fa fa-image"></i> Gallery <span><i class="fa fa-chevron-right"></i></span>
												</a>
											</li>
											<li>
												<a href="https://astylers.com/maintenance/">
													<i class="fa fa-wrench"></i> Maintenance <span><i class="fa fa-chevron-right"></i></span>
												</a>
											</li>
											<li>
												<a href="https://astylers.com/page-not-found/">
													<i class="fa fa-exclamation-triangle"></i> Page not found <span><i class="fa fa-chevron-right"></i></span>
												</a>
											</li>
											<li>
												<a href="https://astylers.com/pricing-table/">
													<i class="fa fa-dollar-sign"></i> Pricing Table <span><i class="fa fa-chevron-right"></i></span>
												</a>
											</li>
											<li>
												<a href="https://astylers.com/services/">
													<i class="fa fa-rocket"></i> Services <span><i class="fa fa-chevron-right"></i></span>
												</a>
											</li>
											<li>
												<a href="https://astylers.com/skill/">
													<i class="fa fa-trophy"></i> Skill <span><i class="fa fa-chevron-right"></i></span>
												</a>
											</li>
										</ul>
									</div>
								</div>
								<!-- end pages -->
								<div class="separator-big"></div>
							</div>
							<!-- end tabs 3 -->
							<!-- tabs 4 -->
							<div id="profile-page" class="tab page-content">
								<!-- apps -->
								<div class="container">
									<div class="separator"></div>
									<div class="list-li">
										<ul>
											<li>
												<a href="https://astylers.com/walkthrough/">
													<i class="fa fa-star"></i> Walkthrough <span><i class="fa fa-chevron-right"></i></span>
												</a>
											</li>
											<li>
												<a href="https://astylers.com/login/">
													<i class="fa fa-sign-in-alt"></i> Login <span><i class="fa fa-chevron-right"></i></span>
												</a>
											</li>
											<li>
												<a href="https://astylers.com/register/">
													<i class="fa fa-user-plus"></i> Register <span><i class="fa fa-chevron-right"></i></span>
												</a>
											</li>
											<li>
												<a href="https://astylers.com/reset-password/">
													<i class="fa fa-credit-card"></i> Reset Password <span><i class="fa fa-chevron-right"></i></span>
												</a>
											</li>
											<li>
												<a href="https://astylers.com/contact-us/">
													<i class="fa fa-envelope"></i> Contact us <span><i class="fa fa-chevron-right"></i></span>
												</a>
											</li>
											<li>
												<a href="https://astylers.com/calendar/">
													<i class="fa fa-calendar"></i> Calendar <span><i class="fa fa-chevron-right"></i></span>
												</a>
											</li>
											<li>
												<a href="https://astylers.com/profile/">
													<i class="fa fa-user"></i> Profile <span><i class="fa fa-chevron-right"></i></span>
												</a>
											</li>
											<li>
												<a href="https://astylers.com/profile-edit/">
													<i class="fa fa-edit"></i> Edit Profile <span><i class="fa fa-chevron-right"></i></span>
												</a>
											</li>
											<li>
												<a href="https://astylers.com/faq/">
													<i class="fa fa-question"></i> Faq <span><i class="fa fa-chevron-right"></i></span>
												</a>
											</li>
											<li>
												<a href="https://astylers.com/logout/">
													<i class="fa fa-power-off"></i> Logout <span><i class="fa fa-chevron-right"></i></span>
												</a>
											</li>
										</ul>
									</div>
								</div>
								<!-- end apps -->
								<div class="separator-big"></div>
							</div>
							<!-- end tabs 4 -->
							
						</div>
					</div>
					<!-- end tabs -->
				</div>
                <div class="page page-current">
                    <!-- navbar -->
                   <div class="navbar">
                       <div class="navbar-inner sliding navbar-pages">
                           <a class="link back" onclick="window.open('{% url "home" %}','_self')">
                               <i class="fa fa-chevron-left"></i>
                           </a>
                           <h4>Donners</h4>
                          <div class="item-right"></div>
                       </div>
                   </div>
                   <!-- end navbar -->
                   <div class="page-content">
                           
                           <!-- career -->
                           <div class="career segments-page">
                               <div class="container">
								<!-- warning popup  -->
								<div id="warning" class="popup popup-attention" style="display: none;">
									<i class="fas fa-exclamation-triangle"></i>
									<h1>Warning</h1>
									<div class="separator-small"></div>
									<p id="available">{{warning.available|linebreak|safe}}</p>
									<p id="not_available">{{warning.not_available|linebreak|safe}}</p>
				
									<a href="#" class="link popup-close buttons">Ok</a>
								</div>
								<!-- warning popup ended  -->

                                <div class="profile-edit">
                                    <div class="content-edit">
                                        <div class="separator-small"></div>
                
                                        <div class="wrap-form">
                                            <form class="list no-hairlines-md" method="post">
												{% csrf_token %}
                                                <ul>
                                                    <li class="item-content item-input">
                                                        <div class="item-inner">
                                                            <div class="item-title item-label">District <i class="fa fa-chevron-down"></i></div>
                                                            <div class="item-input-wrap">
                                                                <select name="district" id="district" class="">
																	{% if selected_district %}
																		<option value="{{selected_district}}">{{selected_district}}</option>
																	{% else %}
                                                                    	<option value="">Select Your District</option>
																	{% endif %}

                                                                    {% for d in district %}
																		<option value="{{d.district}}">{{d.district}}</option>
																	{% endfor %}
                                                                </select>
                                                                <span class="input-clear-button"></span>
                                                            </div>
                                                        </div>
                                                    </li>
                                                    <li class="item-content item-input">
                                                        <div class="item-inner">
                                                            <div class="item-title item-label">Upazila <i class="fa fa-chevron-down"></i></div>
                                                            <div class="item-input-wrap">
                                                                <select id="upazila" name="upazila">
                                                                    {% if selected_upazila %}
																		<option value="{{selected_upazila}}">{{selected_upazila}}</option>
																	{% else %}
                                                                    	<option value="">At first select district</option>
																	{% endif %}
                                                                </select>
                                                                <span class="input-clear-button"></span>
                                                            </div>
                                                        </div>
                                                    </li>

                                                    <li class="item-content item-input">
                                                        <div class="item-inner">
                                                            <div class="item-title item-label">Union <i class="fa fa-chevron-down"></i></div>
                                                            <div class="item-input-wrap">
                                                                <select id="union" name="unions">
																	{% if selected_union %}
																		<option value="{{selected_union}}">{{selected_union}}</option>
																	{% else %}
                                                                    	<option value="">At first select Upazila</option>
																	{% endif %}
                                                                </select>
                                                                <span class="input-clear-button"></span>
                                                            </div>
                                                        </div>
                                                    </li>
                                                </ul>
												
												<div class="separator"></div>
												{% if error %}
													<p style="color: red; font-size: 17px;">
														{{ error }}
													</p>
													<div class="separator-small"></div>
												{% endif %}		
												<button type="submit" class="buttons buttons-center buttons-full">Search Donner</button>
                                            </form>
                                            <div class="separator"></div>
                                        </div>
                                    </div>
                                </div>
									{% if donners %}
										{% for donner in donners %}
											<!-- single donner -->
											<div class="content donner" data-donner="{% if donner.last_donation|previous_donation < 90 %}disable{% else %}{{donner.user.username}}{% endif %}">
												<div class="row">
													<div class="col">
														<div class="left-icon icon-red">
															<img src="{{donner.image.url}}" alt="{{donner.name}}" style="height: 50px; width: 50px; border-radius: 50%;">
														</div>
														<div class="text">
															<h5><b>Name:</b> {{donner.name}}</h5>
															
															<p><b>Total Donations:</b> {{donner.total_donation}}</p>
															<p><b>Previous Donation:</b> 
																{% if donner.last_donation|previous_donation < 90 %}
																	{{donner.last_donation|previous_donation}} days ago
																{% else %}
																	more then 90 days ago
																{% endif %}
															</p>
															<p><b>Address:</b> {{donner.address}}</p>
															<button class="buttons popup-open" data-popup=".popup-attention">Contact</button>
														</div>
													</div>
												</div>
											</div>
											<div class="separator-small"></div>
										{% endfor %}
									{% else %}
											<div class="separator-big"></div>
											<div class="separator-small"></div>
											<h1 class="text-center" style="color:#E74856">Sorry No donners found </h1>

									{% endif %}
                                   <!-- single donner -->
                                   
                               </div>
                           </div>
                           <!-- end career -->
               
                           <!-- separator -->
                           <div class="separator"></div>
                           <!-- end separator -->
                       </div>
                       <!-- end about us -->
                   </div>
			</div>
		</div>
		<!-- script -->
		<script src="{% static 'js/framework7.bundle.min.js' %}"></script>
		<script src="{% static 'js/routes.js' %}"></script>
		<script src="{% static 'js/app.js' %}"></script>
		<script src="{% static 'js/app.js' %}"></script>
		<!-- end script -->

		<script>
			let warning = document.querySelector('#warning');
			let link = warning.querySelector('a.buttons');
			let available = warning.querySelector('p#available');
			let not_available = warning.querySelector('p#not_available');
			let donners = document.querySelectorAll('div.donner');
			
			donners.forEach(donner => {
				let btn = donner.querySelector('button');
				btn.addEventListener('click', () =>{
					let get_donner = donner.dataset.donner;
					if(get_donner != 'disable'){
						let url = "{% url "donner-profile" %}"+"?user="+get_donner;
						link.setAttribute('onclick', `window.open('${url}','_self')`);
						available.style.display = 'block';
						not_available.style.display = 'none';
					}else{
						not_available.style.display = 'block';
						available.style.display = 'none';
					}
				});
			})

			let available_upazila = {
				{% for d in district %}
						"{{d.district}}":[
							{% for upazila in d.upazila_set.all %}"{{upazila.upazila}}",{% endfor %}
						],
				{% endfor %}
			};

			let available_unions = {
				{% for u in upazila %}
						"{{u.upazila}}":[
							{% for unions in u.unions_set.all %}"{{unions.unions}}",{% endfor %}
						],
				{% endfor %}
			};

			function addressChainDropwon(){
				let district = document.querySelector('select#district');
				let upazila = document.querySelector('select#upazila');
				let unions = document.querySelector('select#union');

				district.addEventListener('change',(e)=>{
					let value = e.target.value;
					let upazila_list = available_upazila[value];
					upazila.innerHTML = "<option disabled selected>Select Your Upazila</option>";

					upazila_list.forEach((up)=>{
						let option = document.createElement('option');
						option.text = up;
						option.value = up;
						upazila.appendChild(option);
					});
				});

				upazila.addEventListener('change',(e)=>{
					let value = e.target.value;
					let unions_list = available_unions[value];
					unions.innerHTML = innerHTML = "<option disabled selected>Select Your Union</option>";;

					unions_list.forEach((up)=>{
						let option = document.createElement('option');
						option.text = up;
						option.value = up;
						unions.appendChild(option);
					});
				});
			}
			addressChainDropwon()
		</script>
	</body>
</html>